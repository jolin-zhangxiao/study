<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åŒ—å¤§é™„å°ä¸€å¹´çº§ä¸Šå¤è¯—æ–‡èƒŒè¯µæŠ½æŸ¥ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>å¤è¯—æ–‡èƒŒè¯µæŠ½æŸ¥ç³»ç»Ÿ</h1>
        <div class="progress">
            <span id="progressText">è¿›åº¦ï¼š0/0 (0%)</span>
        </div>
     <button onclick="startSelection()" class="btn-primary">å¼€å§‹æŠ½é€‰</button>
     <button onclick="resetProgress()" class="btn-danger">é‡ç½®è¿›åº¦</button>
    
        <div id="selectionArea"></div>
        
        <div class="memorized-list">
            <h3>å¾…èƒŒè¯µè¯—æ–‡ï¼š</h3>
            <div id="unmemorizedList"></div>
            <h3>å·²èƒŒè¯µè¯—æ–‡ï¼š</h3>
            <div id="memorizedList"></div>
        </div>

        <div class="history">
            <h3>æœ€è¿‘æŠ½é€‰è®°å½•ï¼š</h3>
            <div id="historyList"></div>
        </div>
    </div>

    <!-- å¼¹çª—ç»“æ„ -->
    <div id="poemModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle"></h2>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–å¤è¯—æ•°æ®
        let poems = [

            {
                title: "ä¸‰å­—ç»ï¼ˆèŠ‚é€‰ï¼‰",
                content: `ç‰ä¸ç¢ï¼Œä¸æˆå™¨ã€‚\näººä¸å­¦ï¼Œä¸çŸ¥ä¹‰ã€‚\nä¸ºäººå­ï¼Œæ–¹å°‘æ—¶ã€‚\näº²å¸ˆå‹ï¼Œä¹ ç¤¼ä»ªã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å±±æ‘å’æ€€",
                content: `[å®‹] é‚µé›\n\nä¸€å»äºŒä¸‰é‡Œï¼Œ\nçƒŸæ‘å››äº”å®¶ã€‚\näº­å°å…­ä¸ƒåº§ï¼Œ\nå…«ä¹åæèŠ±ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "ç”»",
                content: `[å”] ç‹ç»´\n\nè¿œçœ‹å±±æœ‰è‰²ï¼Œ\nè¿‘å¬æ°´æ— å£°ã€‚\næ˜¥å»èŠ±è¿˜åœ¨ï¼Œ\näººæ¥é¸Ÿä¸æƒŠã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é™å¤œæ€",
                content: `[å”] æç™½\n\nåºŠå‰æ˜æœˆå…‰ï¼Œ\nç–‘æ˜¯åœ°ä¸Šéœœã€‚\nä¸¾å¤´æœ›æ˜æœˆï¼Œ\nä½å¤´æ€æ•…ä¹¡ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å¤æœ—æœˆè¡Œï¼ˆèŠ‚é€‰ï¼‰",
                content: `[å”] æç™½\n\nå°æ—¶ä¸è¯†æœˆï¼Œ\nå‘¼ä½œç™½ç‰ç›˜ã€‚\nåˆç–‘ç‘¶å°é•œï¼Œ\né£åœ¨é’äº‘ç«¯ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é£",
                content: `[å”] æå³¤\n\nè§£è½ä¸‰ç§‹å¶ï¼Œ\nèƒ½å¼€äºŒæœˆèŠ±ã€‚\nè¿‡æ±Ÿåƒå°ºæµªï¼Œ\nå…¥ç«¹ä¸‡ç«¿æ–œã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å’é¹…",
                content: `[å”] éª†å®¾ç‹\n\né¹…ï¼Œé¹…ï¼Œé¹…ï¼Œ\næ›²é¡¹å‘å¤©æ­Œã€‚\nç™½æ¯›æµ®ç»¿æ°´ï¼Œ\nçº¢æŒæ‹¨æ¸…æ³¢ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å›­æœ",
                content: `[å”] ç‹å»º\n\né›¨ä¸­æ¢¨æœç—…ï¼Œ\næ¯æ ‘æ— æ•°ä¸ªã€‚\nå°å„¿å‡ºå…¥çœ‹ï¼Œ\nä¸€åŠé¸Ÿå•„ç ´ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é¢˜ç§‹æ±Ÿç‹¬é’“å›¾",
                content: `[æ¸…] ç‹å£«ç¥¯\n\nä¸€è“‘ä¸€ç¬ ä¸€æ‰èˆŸï¼Œ\nä¸€ä¸ˆä¸çº¶ä¸€å¯¸é’©ã€‚\nä¸€æ›²é«˜æ­Œä¸€æ¨½é…’ï¼Œ\nä¸€äººç‹¬é’“ä¸€æ±Ÿç§‹ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é¸Ÿé¸£æ¶§",
                content: `[å”] ç‹ç»´\n\näººé—²æ¡‚èŠ±è½ï¼Œ\nå¤œé™æ˜¥å±±ç©ºã€‚\næœˆå‡ºæƒŠå±±é¸Ÿï¼Œ\næ—¶é¸£æ˜¥æ¶§ä¸­ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ˜¥æ™“",
                content: `[å”] å­Ÿæµ©ç„¶\n\næ˜¥çœ ä¸è§‰æ™“ï¼Œ\nå¤„å¤„é—»å•¼é¸Ÿã€‚\nå¤œæ¥é£é›¨å£°ï¼Œ\nèŠ±è½çŸ¥å¤šå°‘ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "ç™»é¹³é›€æ¥¼",
                content: `[å”] ç‹ä¹‹æ¶£\n\nç™½æ—¥ä¾å±±å°½ï¼Œ\né»„æ²³å…¥æµ·æµã€‚\næ¬²ç©·åƒé‡Œç›®ï¼Œ\næ›´ä¸Šä¸€å±‚æ¥¼ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ‰€è§",
                content: `[æ¸…] è¢æš\n\nç‰§ç«¥éª‘é»„ç‰›ï¼Œ\næ­Œå£°æŒ¯æ—æ¨¾ã€‚\næ„æ¬²æ•é¸£è‰ï¼Œ\nå¿½ç„¶é—­å£ç«‹ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ¢…èŠ±",
                content: `[å®‹] ç‹å®‰çŸ³\n\nå¢™è§’æ•°ææ¢…ï¼Œ\nå‡Œå¯’ç‹¬è‡ªå¼€ã€‚\né¥çŸ¥ä¸æ˜¯é›ªï¼Œ\nä¸ºæœ‰æš—é¦™æ¥ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å­å¤œå››æ—¶æ­ŒÂ·æ˜¥æ­Œ",
                content: `[å—æœ] ä¹åºœæ°‘æ­Œ\n\næ˜¥é£åŠ¨æ˜¥å¿ƒï¼Œ\næµç›®ç©å±±æ—ã€‚\nå±±æ—å¤šå¥‡é‡‡ï¼Œ\né˜³é¸Ÿåæ¸…éŸ³ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ¢…æºª",
                content: `[å”] å¼ ç±\n\nè‡ªçˆ±æ–°æ¢…å¥½ï¼Œ\nè¡Œå¯»ä¸€å¾„æ–œã€‚\nä¸æ•™äººæ‰«çŸ³ï¼Œ\nææŸè½æ¥èŠ±ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "è½å¶",
                content: `[éš‹] å­”ç»å®‰\n\næ—©ç§‹æƒŠè½å¶ï¼Œ\né£˜é›¶ä¼¼å®¢å¿ƒã€‚\nç¿»é£æœªè‚¯ä¸‹ï¼Œ\nçŠ¹è¨€æƒœæ•…æ—ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é™¶è€…",
                content: `[å®‹] æ¢…å°§è‡£\n\né™¶å°½é—¨å‰åœŸï¼Œ\nå±‹ä¸Šæ— ç‰‡ç“¦ã€‚\nåæŒ‡ä¸æ²¾æ³¥ï¼Œ\né³é³å±…å¤§å¦ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ‚¯å†œï¼ˆå…¶ä¸€ï¼‰",
                content: `[å”] æç»…\n\næ˜¥ç§ä¸€ç²’ç²Ÿï¼Œ\nç§‹æ”¶ä¸‡é¢—å­ã€‚\nå››æµ·æ— é—²ç”°ï¼Œ\nå†œå¤«çŠ¹é¥¿æ­»ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ‚¯å†œï¼ˆå…¶äºŒï¼‰",
                content: `[å”] æç»…\n\né”„ç¦¾æ—¥å½“åˆï¼Œ\næ±—æ»´ç¦¾ä¸‹åœŸã€‚\nè°çŸ¥ç›˜ä¸­é¤ï¼Œ\nç²’ç²’çš†è¾›è‹¦ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "ç»å¥Â·ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³",
                content: `[å”] æœç”«\n\nä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³ï¼Œ\nä¸€è¡Œç™½é¹­ä¸Šé’å¤©ã€‚\nçª—å«è¥¿å²­åƒç§‹é›ªï¼Œ\né—¨æ³Šä¸œå´ä¸‡é‡Œèˆ¹ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é¹¿æŸ´",
                content: `[å”] ç‹ç»´\n\nç©ºå±±ä¸è§äººï¼Œ\nä½†é—»äººè¯­å“ã€‚\nè¿”æ™¯å…¥æ·±æ—ï¼Œ\nå¤ç…§é’è‹”ä¸Šã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é©¬ï¼ˆå…¶äº”ï¼‰",
                content: `[å”] æè´º\n\nå¤§æ¼ æ²™å¦‚é›ªï¼Œ\nç‡•å±±æœˆä¼¼é’©ã€‚\nä½•å½“é‡‘ç»œè„‘ï¼Œ\nå¿«èµ°è¸æ¸…ç§‹ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "å¤œå®¿å±±å¯º",
                content: `[å”] æç™½\n\nå±æ¥¼é«˜ç™¾å°ºï¼Œ\næ‰‹å¯æ‘˜æ˜Ÿè¾°ã€‚\nä¸æ•¢é«˜å£°è¯­ï¼Œ\nææƒŠå¤©ä¸Šäººã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "é¸Ÿ",
                content: `[å”] ç™½å±…æ˜“\n\nè°é“ç¾¤ç”Ÿæ€§å‘½å¾®ï¼Œ\nä¸€èˆ¬éª¨è‚‰ä¸€èˆ¬çš®ã€‚\nåŠå›è«æ‰“æå¤´é¸Ÿï¼Œ\nå­åœ¨å·¢ä¸­æœ›æ¯å½’ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "èˆŸå¤œä¹¦æ‰€è§",
                content: `[æ¸…] æŸ¥æ…è¡Œ\n\næœˆé»‘è§æ¸”ç¯ï¼Œ\nå­¤å…‰ä¸€ç‚¹è¤ã€‚\nå¾®å¾®é£ç°‡æµªï¼Œ\næ•£ä½œæ»¡æ²³æ˜Ÿã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "æ˜¥è¡Œå³å…´",
                content: `[å”] æå\n\nå®œé˜³åŸä¸‹è‰è‹è‹ï¼Œ\næ¶§æ°´ä¸œæµå¤å‘è¥¿ã€‚\nèŠ³æ ‘æ— äººèŠ±è‡ªè½ï¼Œ\næ˜¥å±±ä¸€è·¯é¸Ÿç©ºå•¼ã€‚`,
                memorized: false,
                showed: false
            },
            {
                title: "ç‰§ç«¥",
                content: `[å”] å•å²©\n\nè‰é“ºæ¨ªé‡å…­ä¸ƒé‡Œï¼Œ\nç¬›å¼„æ™šé£ä¸‰å››å£°ã€‚\nå½’æ¥é¥±é¥­é»„æ˜åï¼Œ\nä¸è„±è“‘è¡£å§æœˆæ˜ã€‚`,
                memorized: false,
                showed: false
            }
        ];

        let isSelecting = false;
        let history = [];

        // åˆ·æ–°åˆ—è¡¨æ˜¾ç¤º
        function refreshLists() {
            const unmemorized = poems.filter(p => !p.memorized);
            const memorized = poems.filter(p => p.memorized);

            document.getElementById('unmemorizedList').innerHTML = 
                unmemorized.map(p => `
                    <div class="poem-item unmemorized">
                        ${p.title}${p.showed ? ' (å·²æŸ¥çœ‹)' : ''}
                    </div>
                `).join('');

            document.getElementById('memorizedList').innerHTML = 
                memorized.map(p => `
                    <div class="poem-item memorized">${p.title} âœ“</div>
                `).join('');

            updateProgress();
            saveToLocalStorage();
            checkCompletion();
        }

        // å¼€å§‹æŠ½é€‰
        function startSelection() {
            if(isSelecting || poems.every(p => p.memorized)) return;
            
            const availablePoems = poems.filter(p => !p.memorized && !p.showed);
            if(availablePoems.length === 0) {
                resetShowedStatus();
                return;
            }

            isSelecting = true;
            let counter = 0;
            const selectionArea = document.getElementById('selectionArea');
            
            const interval = setInterval(() => {
                const randomIndex = Math.floor(Math.random() * availablePoems.length);
                selectionArea.innerHTML = buildPoemCard(availablePoems[randomIndex]);
                counter++;

                if(counter > 10) {
                    clearInterval(interval);
                    finalizeSelection(availablePoems[randomIndex]);
                    isSelecting = false;
                }
            }, 100);
        }

        // æ„å»ºè¯—æ–‡å¡ç‰‡
        function buildPoemCard(poem) {
            return `
                <div class="poem-card scroll-effect">
                    <h2 class="title" 
                        onclick="showContent('${poem.title}')">
                        ${poem.title}
                    </h2>
                    <button id="memorizeBtn" 
                        onclick="markMemorized('${poem.title}')" 
                        style="background-color: #4CAF50; color: white;">
                        æ ‡è®°å·²èƒŒ
                    </button>
                </div>
            `;
        }

        // æ˜¾ç¤ºå¼¹çª—
        function showContent(title) {
            const poem = poems.find(p => p.title === title);
            if(poem && !poem.showed) {
                showModal(poem);
                poem.showed = true;
                refreshLists();
            }
        }

        // æ˜¾ç¤ºå¼¹çª—
        function showModal(poem) {
            const modal = document.getElementById('poemModal');
            document.getElementById('modalTitle').textContent = poem.title;
            document.getElementById('modalContent').innerHTML = poem.content.replace(/\n/g, '<br>');
            modal.style.display = 'block';
            
            modal.onclick = function(e) {
                if(e.target === modal) closeModal();
            }
        }

        // å…³é—­å¼¹çª—
        function closeModal() {
            document.getElementById('poemModal').style.display = 'none';
        }

        // æ ‡è®°å·²èƒŒ
        function markMemorized(title) {
            const poem = poems.find(p => p.title === title);
            if(poem && !poem.showed) {
                poem.memorized = true;
                refreshLists();
                startSelection();
            }
        }

        // é‡ç½®æ˜¾ç¤ºçŠ¶æ€
        function resetShowedStatus() {
            poems.forEach(p => p.showed = false);
            alert("æ‰€æœ‰è¯—æ–‡éƒ½å·²æ˜¾ç¤ºè¿‡ï¼Œå·²é‡ç½®æŸ¥çœ‹çŠ¶æ€ï¼");
            refreshLists();
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const memorizedCount = poems.filter(p => p.memorized).length;
            const total = poems.length;
            const percent = total > 0 ? Math.round((memorizedCount / total) * 100) : 0;
            document.getElementById('progressText').textContent = 
                `è¿›åº¦ï¼š${memorizedCount}/${total} (${percent}%)`;
        }

        // æ£€æŸ¥å®ŒæˆçŠ¶æ€
        function checkCompletion() {
            if(poems.every(p => p.memorized)) {
                document.getElementById('selectionArea').innerHTML = `
                    <div class="poem-card" style="background-color: #e8f5e9">
                        <h2>ğŸ‰ æ­å–œå®Œæˆæ‰€æœ‰èƒŒè¯µä»»åŠ¡ï¼</h2>
                    </div>`;
            }
        }

        // é‡ç½®è¿›åº¦
        function resetProgress() {
            if(confirm("ç¡®å®šè¦é‡ç½®æ‰€æœ‰è¿›åº¦å—ï¼Ÿ")) {
                poems.forEach(p => {
                    p.memorized = false;
                    p.showed = false;
                });
                history = [];
                localStorage.removeItem('poemData');
                refreshLists();
                document.getElementById('selectionArea').innerHTML = '';
            }
        }

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToLocalStorage() {
            localStorage.setItem('poemData', JSON.stringify({
                poems: poems,
                history: history
            }));
        }

        // æœ€ç»ˆç¡®å®šé€‰æ‹©
        function finalizeSelection(poem) {
            history.unshift({
                poem: poem.title,
                time: new Date().toLocaleString()
            });
            history = history.slice(0, 5); // ä¿ç•™æœ€è¿‘5æ¡è®°å½•
            updateHistory();
        }

        // æ›´æ–°å†å²è®°å½•
        function updateHistory() {
            document.getElementById('historyList').innerHTML = 
                history.map((h, i) => `
                    <div>${i+1}. ${h.poem} - ${h.time}</div>
                `).join('');
        }

        // åˆå§‹åŒ–åŠ è½½
        window.onload = () => {
            const savedData = localStorage.getItem('poemData');
            if(savedData) {
                const data = JSON.parse(savedData);
                poems = data.poems || poems;
                history = data.history || [];
            }
            refreshLists();
            updateHistory();
        }
    </script>
</body>
</html>